---
sidebar_position: 6
---

# Repository Organisation

## Directory Structure

```
ğŸ“ config                            (configuration parameters used by pyra core)
    ğŸ“„ config.json                       (excluded from repository, used by pyra core)
    ğŸ“„ config.default.json               (template)
    ğŸ“„ helios.config.default.json        (template)
    ğŸ“„ tum_plc.config.default.json       (template)
    ğŸ“„ upload.config.default.json        (template)

ğŸ“ logs                              (logs and other ouput that pyra core produces)
    ğŸ“„ info.log                          (log lines from last 60 minutes)
    ğŸ“„ debug.log                         (log lines from last 60 minutes)
    ğŸ“ archive                           (daily log files for all older log lines)
    ğŸ“ activity                          (activity logs, JSONs, only important events)
    ğŸ“ helios                            (images generated by Helios')
    ğŸ“ helios-autoexposure               (images generated by Helios' autoexposure routine)

ğŸ“ packages                          (contains the code for pyra core, cli, and ui)
    ğŸ“ core                              (entry point is "main.py")
    ğŸ“ cli                               (entry point is "main.py")
    ğŸ“ ui                                (project structure based on Tauri and Vite)

ğŸ“ scripts                           (custom scripts that perform various manual things)
    ğŸ“„ get_upload_dir_checksum.py        (run MyPy on core and cli)
    ğŸ“„ run_type_analysis.py              (run MyPy on core and cli)
    ğŸ“„ sync_version_numbers.py           (sync version number in all three locations)

ğŸ“ tests                             (test which can be run using Pytest)
    ğŸ“ cli                               (can be run in a CI environment)
    ğŸ“ integration                       (can only be run in a working EM27 system)
    ğŸ“ repository                        (can be run in a CI environment)

ğŸ“ website                           (documentation generate with Docusaurus)
```

## Branch Structure

**Branches:** `development-...`, `integration-x.y.z`, `main`, `release`, `prerelease`

**Hierarchy:** `development-...` contains stuff in active development and will be merged into `integration-x.y.z`. `integration-x.y.z`: Is used during active integration on the stations and will be merged into `main`. `main` contains the latest running version that passed the integration and will be merged into `release` once enough changes have accumulated. Any branch can be released into `prerelease` to run the CI-Pipeline on demand. `prerelease` will not be merged into anything else and is just used for development purposes.

<!--TODO: add mermaid drawing of branch hierarchy-->

## TODO Issues and Releases

**Issues:** Things we work on are managed via issues - which are bundled into milestones (each milestone represents a release). The issues should be closed once they are on the `main` branch via commit messages ("closes #87", "fixes #70", etc. see [this list of keywords](https://docs.github.com/en/issues/tracking-your-work-with-issues/linking-a-pull-request-to-an-issue#linking-a-pull-request-to-an-issue-using-a-keyword)). Issues that have been finished but are not on the `main` branch yet, can be labeled using the white label "implemented". This way, we can oversee incompleted issues, but don't forget to merge them.

<!--TODO: mention "backlog" label -->
<!--TODO: mention "Update: ..." label -->
<!--TODO: add colors to labels in text-->

## Release Cycle

TODO: How often, features, etc. (take the one from README)

:::info

We integrate new releases on two different machines (**ma** and **mb**). When the new software is running smoothly for some time, we make it an official release.

:::

## Version numbers

Versions up to `4.0.4` are alpha and beta versions that should not be used regularly. PYRA can be generally used starting from version `4.0.5`.

Inside the codebase, the version number is included 3 times: `pyproject.toml`, `packages/ui/package.json`, `packages/ui/src-tauri/tauri.conf.json`. The script `scripts/sync_version_numbers.py` takes the version number from the `.toml` file and pastes it into the other locations. This script can be run in a [git-hook](https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks).
