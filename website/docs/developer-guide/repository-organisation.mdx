---
sidebar_position: 6
---

# Repository Organisation

## Directory Structure

```
📁 .github                           (contains GitHub Actions workflows)

📁 config                            (configuration parameters used by pyra core)
    📄 config.json                       (not in repository, used by pyra core)
    📄 config.default.json               (template)
    📄 helios.config.default.json        (template)
    📄 tum_plc.config.default.json       (template)
    📄 upload.config.default.json        (template)

📁 logs                              (logs and other ouput that pyra core produces)
    📄 info.log                          (log lines from last 60 minutes)
    📄 debug.log                         (log lines from last 60 minutes)
    📁 archive                           (daily log files for all older log lines)
    📁 activity                          (activity logs, JSONs, only major events)
    📁 helios                            (images generated by Helios')
    📁 helios-autoexposure               (images from Helios' autoexposure routine)

📁 packages                          (contains the code for pyra core, cli, and ui)
    📁 core                              (entry point is "main.py")
    📁 cli                               (entry point is "main.py")
    📁 ui                                (project structure based on Tauri and Vite)

📁 runtime-data                      (where pyra core will put temporary data)

📁 scripts                           (scripts for manual things)
    📄 get_upload_dir_checksum.py        (calculate an upload dir checksum)
    📄 run_type_analysis.py              (run MyPy on core and cli)
    📄 sync_version_numbers.py           (sync version number in all locations)

📁 tests                             (test which can be run using Pytest)
    📁 cli                               (can be run in a CI environment)
    📁 integration                       (can only be run on working EM27 systems)
    📁 repository                        (can be run in a CI environment)

📁 website                           (documentation generate with Docusaurus)
```

## Branch Structure

**Branches:** `development-...`, `integration-x.y.z`, `main`, `release`, `prerelease`

**Hierarchy:** `development-...` contains stuff in active development and will be merged into `integration-x.y.z`. `integration-x.y.z`: Is used during active integration on the stations and will be merged into `main`. `main` contains the latest running version that passed the integration and will be merged into `release` once enough changes have accumulated. Any branch can be released into `prerelease` to run the CI-Pipeline on demand. `prerelease` will not be merged into anything else and is just used for development purposes.

```mermaid
graph TD;
    A["development-person2"]-- "on finishing a set of features" -->C;
    B["development-person1"]-- "on finishing a set of features" -->C;
    C["integration-x.y.z"]-- "after successful integration" -->D;
    D["main"]-- "when creating a release" -->E["release"];
    F["any-branch"]-- "on-demand to bundle the UI" -->G["prerelease"];
```

## Issues and Releases

Things we work on are managed via issues - which are bundled into milestones (each milestone represents a release). The issues should be closed once they are on the `main` branch via commit messages or pull requests ("closes #87", "fixes #70", etc. see [this list of keywords](https://docs.github.com/en/issues/tracking-your-work-with-issues/linking-a-pull-request-to-an-issue#linking-a-pull-request-to-an-issue-using-a-keyword)).

**Issue Labels:**

-   <span className='tw-bg-gray-200 tw-text-gray-700 tw-px-1.5 tw-py-0.5 tw-rounded tw-font-mono tw-text-sm tw-font-bold'>
        implemented
    </span>
    : Issues that have been finished but are not on the `main` branch yet.
-   <span className='tw-bg-gray-800 tw-text-gray-150 tw-px-1.5 tw-py-0.5 tw-rounded tw-font-mono tw-text-sm tw-font-bold'>
        backlog
    </span>
    : Issues that are not urgent (feature ideas, improvements, etc.)
-   <span className='tw-bg-purple-800 tw-text-purple-50 tw-px-1.5 tw-py-0.5 tw-rounded tw-font-mono tw-text-sm tw-font-bold'>
        Update: ...
    </span>
    : Used, once we have a set of things for a good release package

Planned releases are described in the [Roadmap](/docs/developer-guide/roadmap) section.

:::info

We integrate new releases on two different machines (**ma** and **mb**). When the new software is running smoothly for some time, we make it an official release.

:::

## Version numbers

Versions up to `4.0.4` are alpha and beta versions that should not be used regularly. PYRA can be generally used starting from version `4.0.5`.

Inside the codebase, the version number is included 3 times: `pyproject.toml`, `packages/ui/package.json`, `packages/ui/src-tauri/tauri.conf.json`. The script `scripts/sync_version_numbers.py` takes the version number from the `.toml` file and pastes it into the other locations. This script can be run in a [git-hook](https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks).
